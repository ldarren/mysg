{
    "deps":{
        "util":"api/util",
		"fb":"api/fb",
		"fbGeneral":"api/fbGeneral",
		"fbAddTrip":"api/fbAddTrip",
		"fbViewTrip":"api/fbViewTrip",
		"fbFindTrip":"api/fbFindTrip",
		"fbJoinTrip":"api/fbJoinTrip",
        "web":["context","webServer"]
    },      
    "routes":{
        "/mysg":[
            ["util","route","req"],
			["web","parse","req","res"]
        ],
        "/mysg/fb/webhook":[
            ["fb","$route","req"],
			["web","getBody","req","body"],
			["fb","parse","body"],
			[]
        ],
		"fb/validate":[
			["fb","verify","query"],
			[]
		],
		"fb/lostAt":[
			["fb","prepare",["user",":action","name"]],
			["fbGeneral","nextStep","user",":action","name"]
		],
		"fb/addUser":[
			["fb","prepare",["user",":action"]],
			["fb","getUser","user"],
			["fbGeneral","nextStep","user",":action",["Role"]]
		],
		"fb/askRole|#prefix":[
			["fb","prepare",["user"]],
			["fbGeneral","askRole","user","msg"],
			["fb","send","msg"]
		],
		"fb/addRole":[
			["fb","prepare",["user",":action","evt"]],
			["fbGeneral","addRole","user",":action","evt"],
			["fbGeneral","nextStep","user",":action",["Action"]]
		],
		"fb/askAction|#prefix":[
			["fb","prepare",["user"]],
			["fbGeneral","askAction","user","msg"],
			["fb","send","msg"]
		],
		"fb/addAction":[
			["fb","prepare",["user",":action","evt"]],
			["fbGeneral","$addAction","user",":action","evt",["name"]],
			["fbGeneral","nextStep","user",":action","name"]
		],
		"fb/askTripDate|#prefix":[
			["fb","prepare",["user"]],
			["fbAddTrip","askDate","user","msg"],
			["fb","send","msg"]
		],
		"fb/addTripDate":[
			["fb","prepare",["user",":action","evt"]],
			["fbAddTrip","addDate","user",":action","evt"],
			["fbGeneral","nextStep","user",":action",["TripTime"]]
		],
		"fb/askTripTime|#prefix":[
			["fb","prepare",["user"]],
			["fbGeneral","createMsg","user","msg",["Pls key in the pick up time in '9:35pm' format"]],
			["fb","send","msg"]
		],
		"fb/addTripTime":[
			["fb","prepare",["user",":action","evt"]],
			["fbAddTrip","addTime","user",":action","evt"],
			["fbGeneral","nextStep","user",":action",["TripFirstPickup"]]
		],
		"fb/askTripFirstPickup|#prefix":[
			["fb","prepare",["user"]],
			["fbGeneral","createMsg","user","msg",["Pls add a pick up location"]],
			["fb","send","msg"]
		],
		"fb/addTripFirstPickup":[
			["fb","prepare",["user",":action","evt"]],
			["fbAddTrip","addPickup","user",":action","evt",["name"]],
			["fbGeneral","nextStep","user",":action","name"]
		],
		"fb/askTripPickup|#prefix":[
			["fb","prepare",["user"]],
			["fbGeneral","createMsg","user","msg",["Pls add another pick up location, or type 'done' to proceed"]],
			["fb","send","msg"]
		],
		"fb/addTripPickup":[
			["fb","prepare",["user",":action","evt"]],
			["fbAddTrip","addPickup","user",":action","evt",["name"]],
			["fbGeneral","nextStep","user",":action","name"]
		],
		"fb/askTripFirstDropoff|#prefix":[
			["fb","prepare",["user"]],
			["fbGeneral","createMsg","user","msg",["Pls add a drop off location"]],
			["fb","send","msg"]
		],
		"fb/addTripFirstDropoff":[
			["fb","prepare",["user",":action","evt"]],
			["fbAddTrip","addDropoff","user",":action","evt",["name"]],
			["fbGeneral","nextStep","user",":action","name"]
		],
		"fb/askTripDropoff|#prefix":[
			["fb","prepare",["user"]],
			["fbGeneral","createMsg","user","msg",["Pls add another drop off location, or type 'done' to proceed"]],
			["fb","send","msg"]
		],
		"fb/addTripDropoff":[
			["fb","prepare",["user",":action","evt"]],
			["fbAddTrip","addDropoff","user",":action","evt",["name"]],
			["fbGeneral","nextStep","user",":action","name"]
		],
		"fb/askTripSeat|#prefix":[
			["fb","prepare",["user"]],
			["fbGeneral","createMsg","user","msg",["Pls specify available seats, e.g. 10"]],
			["fb","send","msg"]
		],
		"fb/addTripSeat":[
			["fb","prepare",["user",":action","evt"]],
			["fbAddTrip","addSeat","user",":action","evt"],
			["fbGeneral","nextStep","user",":action",["TripPrice"]]
		],
		"fb/askTripPrice|#prefix":[
			["fb","prepare",["user"]],
			["fbGeneral","createMsg","user","msg",["Pls add price per pax, e.g. SGD10 pax"]],
			["fb","send","msg"]
		],
		"fb/addTripPrice":[
			["fb","prepare",["user",":action","evt"]],
			["fbAddTrip","addPrice","user",":action","evt"],
			["fbGeneral","nextStep","user",":action",["TripNote"]]
		],
		"fb/askTripNote|#prefix":[
			["fb","prepare",["user"]],
			["fbGeneral","createMsg","user","msg",["Pls add a remarks such as contact info"]],
			["fb","send","msg"]
		],
		"fb/addTripNote":[
			["fb","prepare",["user",":action","evt"]],
			["fbAddTrip","addNote","user",":action","evt"],
			["fbGeneral","finalStep","user",":action"]
		],
		"fb/compileAction":[
			["fb","prepare",["user",":action"]],
			["fbGeneral","$compileAction","user",":action","cmd"]
		],
		"fb/addTrip":[
			["fb","prepare",["user","cmd"]],
			["fbAddTrip","done","user","cmd","msg"],
			["fb","send","msg"]
		],
		"fb/myTrip":[
			["fb","prepare",["user","cmd"]],
			["fbViewTrip","myTrip","user","cmd","msg"],
			["fb","send","msg"]
		],
		"fb/myRide":[
			["fb","prepare",["user","cmd"]],
			["fbViewTrip","myRide","user","cmd","msg"],
			["fb","send","msg"]
		],
		"fb/trip/cancel":[
		],
		"fb/trip/cancel/confirm":[
		],
        "ERR|#msg": [
            []
        ],
        "END|#msg": [
            [] 
        ],
        "#help": [
            ["util","help"] 
        ] 
    }
}   
